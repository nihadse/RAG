import pandas as pd
from ayx import Alteryx

df = Alteryx.read("#1")

output = []

for path in df['FullPath']:
    if path.endswith('.xlsx') or path.endswith('.xls'):
        try:
            xls = pd.ExcelFile(path)
            for sheet in xls.sheet_names:
                output.append({
                    'FullPath': path,
                    'SheetName': sheet
                })
        except Exception as e:
            print(f"Error reading {path}: {e}")
    else:
        print(f"Skipped (not Excel): {path}")

output_df = pd.DataFrame(output)

# Define proper metadata for Alteryx output
metadata = {
    'FullPath': {
        'type': 'V_WString',
        'size': 1000,
        'source': 'PythonTool',
        'description': 'Full file path of Excel'
    },
    'SheetName': {
        'type': 'V_WString',
        'size': 255,
        'source': 'PythonTool',
        'description': 'Sheet name inside Excel file'
    }
}

Alteryx.write(output_df, 1, metadata)





import pandas as pd
from ayx import Alteryx
import os

df = Alteryx.read("#1")

output = []

for path in df['FullPath']:
    if path.endswith('.xlsx') or path.endswith('.xls'):
        try:
            xls = pd.ExcelFile(path)
            for sheet in xls.sheet_names:
                output.append({
                    'FullPath': path,
                    'SheetName': sheet
                })
        except Exception as e:
            print(f"Error reading {path}: {e}")
    else:
        print(f"Skipped (not Excel): {path}")

# Create DataFrame
output_df = pd.DataFrame(output)

# Define metadata
metadata = {
    'FullPath': {
        'type': 'V_WString',
        'size': 500
    },
    'SheetName': {
        'type': 'V_WString',
        'size': 255
    }
}

Alteryx.write(output_df, 1, metadata)




import pandas as pd
import os
from ayx import Alteryx

# Read input data from Alteryx (coming from the Directory Tool)
df = Alteryx.read("#1")  # Make sure Python tool is connected to Directory Tool

output = []

for path in df['FullPath']:
    try:
        xls = pd.ExcelFile(path)
        for sheet in xls.sheet_names:
            output.append({
                'FullPath': path,
                'SheetName': sheet
            })
    except Exception as e:
        print(f"Error reading {path}: {e}")
        continue

# Output the sheet name and file path to next Alteryx tools
Alteryx.write(pd.DataFrame(output), 1)





[FullPath] + "|||SheetName=" + [SheetName]



InputPathWithSheet


import pandas as pd
from ayx import Alteryx

df = Alteryx.read("#1")  # From Directory Tool
output = []

for path in df['FullPath']:
    try:
        xls = pd.ExcelFile(path)
        for sheet in xls.sheet_names:
            output.append({
                'FullPath': path,
                'SheetName': sheet
            })
    except:
        pass

Alteryx.write(pd.DataFrame(output), 1)
